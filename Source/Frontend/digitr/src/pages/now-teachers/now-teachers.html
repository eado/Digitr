<!--
  Generated template for the NowTeachersPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  <ion-toolbar>
      <ion-buttons start>
          <button ion-button (click)="signout()">
            Sign Out
          </button>
        </ion-buttons>
    <ion-segment [(ngModel)]="currentPage">
      <ion-segment-button value="messages">
        Messages
      </ion-segment-button>
      <ion-segment-button value="analytics">
        Analytics
      </ion-segment-button>
    </ion-segment>
    <ion-buttons end>
      <a target="_new" href="https://mpassapp.com">
        <button ion-button icon-only>
          <ion-icon name="help-circle"></ion-icon>
        </button>
      </a>
    </ion-buttons>
  </ion-toolbar>
</ion-header>


<ion-content>
  <div *ngIf="currentPage == 'messages' && user">
    <div *ngIf="user.messages.length < 1">
      <h1 class="nohistory">No messages</h1>
    </div>
    <ion-list *ngFor="let message of user.messages" [ngSwitch]="message.type">
      <ion-list-header>{{ message.user }}</ion-list-header>
      <ion-item text-wrap *ngSwitchCase="'pass_request'">
        <b>{{ message.title }}: </b>{{ message.subTitle }}
        <ion-note item-end color="dark"></ion-note>
        <ion-note item-end>
          <button icon-end ion-button small color="secondary" (click)="approve(message.timestamp)">
            Approve
            <ion-icon name="checkmark-circle"></ion-icon>
          </button>
        </ion-note>
        <ion-note item-end>
          <button icon-end ion-button small color="danger" (click)="deny(message.timestamp, message.email)">
            Deny
            <ion-icon name="remove-circle"></ion-icon>
          </button>
        </ion-note>
      </ion-item>
      <ion-item text-wrap *ngSwitchCase="pass_done">
          <b>{{ message.title }}: </b>{{ message.subTitle }}{{ playSound() }}
          <ion-note item-end><button ion-button small (click)="dismiss(message.timestamp)">Dismiss</button></ion-note>
      </ion-item>
      <ion-item text-wrap *ngSwitchDefault>
        <b>{{ message.title }}: </b>{{ message.subTitle }}
        <ion-note item-end><button ion-button small (click)="dismiss(message.timestamp)">Dismiss</button></ion-note>
      </ion-item>
    </ion-list>
</div>
</ion-content>
